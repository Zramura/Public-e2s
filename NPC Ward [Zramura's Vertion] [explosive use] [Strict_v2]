@name NPC Ward [Zramura's Vertion] [explosive use] [Strict_v2]
@persist Target_Array:array
@trigger none
@strict
#ifdef dupefinished()
if (duped()) { exit() }
#endif
const Filter = array("npc_grenade_bugbait","npc_zombie_grenade","npc_grenade_frag","npc_satchel","npc_tripmine","npc_heli_avoidsphere","npc_template_maker","npcz_aw119_kiowa")
foreach(_:number,Exclude:string=Filter){
    findExcludeClass(Exclude)
}
findIncludeClass("npc_*")
Target_Array = array(),Explosive = "models/props_phx/misc/potato_launcher_explosive.mdl"
propSpawnUndo(0)
timer("find",2.5,0,function(){
    if(findCanQuery()&Target_Array:count()==0){
        findInSphere(entity():pos(),1000)
        findSortByDistance(entity():pos())
        Target_Array = findToArray()
    }elseif(Target_Array:count()>0){
        timerResume("kill")
        timerPause("find")
    }
})
timer("kill",0.05,0,function(){
    if(Target_Array:count()>0){
        const Target_Entity = Target_Array[1,entity]
        if(Target_Entity&Target_Entity:health()>0&propCanCreate()){
            Target_Pos = Target_Entity:toWorld(vec(0,0,Target_Entity:height()*0.5))
            propSpawn(Explosive,Target_Pos,ang(),1):propBreak()
        }else{
            Target_Array:removeEntity(1)
        }
    }else{
        timerPause("kill")
        timerResume("find")
    }
})
